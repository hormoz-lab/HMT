# Tree HMM Simulations

This Jupyter Notebook is designed to simulate a Markov process on binary trees to generate simulated data for testing a tree Hidden Markov Model (HMM).

## Description

The simulation involves generating binary trees where each node represents a state generated by a hidden Markov process. This includes:
- Generating nodes based on conditional probabilities and hidden states.
- Pruning branches probabilistically to introduce variability in the tree structure.
- Utilizing forward and backward algorithms for probabilistic computations across the tree.

## Setup

To run this notebook, ensure you have the following Python libraries installed:
- numpy
- pandas
- matplotlib
- seaborn
- scipy
- sklearn
- collections

You can install these packages via pip:

```bash
pip install numpy pandas matplotlib seaborn scipy sklearn collections
```


## Usage

Follow these steps to utilize this notebook effectively:

1. **Import the Necessary Libraries**: Ensure all required libraries are imported to access their functionalities.

2. **Define the TreeNode Class and Functions**:
   - **TreeNode Class**: Manages the tree structure, including nodes and their properties.
   - **Simulation Functions**: Required for generating the tree structure and performing simulations.

3. **Set Initial Conditions**:
   - Define the number of generations, hidden states, and initial probabilities to set up the simulation environment.

4. **Run the Simulation**:
   - Execute the process to generate trees based on the defined initial conditions.

5. **Visualize and Analyze Results**:
   - Use plotting functions provided within the notebook to visualize and analyze the simulation outcomes.

Example parameters and functions are already set up in the notebook to help you get started with custom simulations.

## Functions Overview

- **generate_node_pair(parent_node, hidden_states, conditional_probs, means, covars, prob_prune)**: Generates a pair of nodes.
- **generate_tree(n_generations, hidden_states, initial_probs, conditional_probs, means, vars, prob_prune)**: Creates an entire tree based on the specified parameters.
- **forward(tree, conditional_probs, means, covars)**: Applies the forward algorithm for probabilistic calculations.
- **backward(tree, node, initial_probs, conditional_probs, means, covars)**: Implements the backward algorithm to compute probabilities.
- **expectation_maximization(trees, hidden_states, initial_probs, conditional_probs, means, covars, num_iterations)**: Executes the EM (Expectation Maximization) algorithm for parameter estimation.
